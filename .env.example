# VytalMind Zero-Trust Gateway Environment Configuration
# Copy this file to .env and update with your values

# ==============================================================================
# DEPLOYMENT MODE
# ==============================================================================
# Choose deployment mode:
# - "standalone": Deploy all services locally (use docker-compose.shared.yml)
# - "production": Use external shared services (Keycloak, OTel, Vault, Prometheus)
DEPLOYMENT_MODE=production

# ==============================================================================
# VAULT CONFIGURATION (External - Required)
# ==============================================================================
VAULT_ADDR=https://vault.odell.com:8200

# Edge Envoy AppRole Credentials
# Get these by running: ./infrastructure/vault/scripts/setup-pki.sh
EDGE_VAULT_ROLE_ID=your-edge-role-id-here
EDGE_VAULT_SECRET_ID=your-edge-secret-id-here

# Internal Envoy AppRole Credentials
# Get these by running: ./infrastructure/vault/scripts/setup-pki.sh
INTERNAL_VAULT_ROLE_ID=your-internal-role-id-here
INTERNAL_VAULT_SECRET_ID=your-internal-secret-id-here

# ==============================================================================
# KEYCLOAK CONFIGURATION
# ==============================================================================
# If using external Keycloak, update this to your Keycloak URL
# Example: https://keycloak.odell.com
KEYCLOAK_URL=http://keycloak:8080

# Keycloak Admin Password (only needed if deploying local Keycloak)
KEYCLOAK_ADMIN_PASSWORD=admin

# Keycloak Realm and Client Configuration
KEYCLOAK_REALM=vytalmind
KEYCLOAK_CLIENT_ID=edge-gateway
KEYCLOAK_CLIENT_SECRET=your-client-secret-change-in-production

# ==============================================================================
# OPENTELEMETRY CONFIGURATION
# ==============================================================================
# If using external OTel Collector, update this URL
# Example: https://otel.odell.com:4317
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317

# ==============================================================================
# PROMETHEUS CONFIGURATION (External - Required)
# ==============================================================================
# Prometheus scrapes metrics from Envoy admin interfaces
# Configure scrape jobs at: https://prometheus.odell.com
PROMETHEUS_URL=https://prometheus.odell.com

# ==============================================================================
# TLS CONFIGURATION
# ==============================================================================
TLS_DOMAIN=gateway.vytalmind.local
TLS_CERT_TTL=8760h  # 1 year

# ==============================================================================
# mTLS PKI CONFIGURATION
# ==============================================================================
PKI_TTL=720h  # 30 days
PKI_MAX_TTL=8760h  # 1 year

# ==============================================================================
# OAUTH2 CONFIGURATION (Apicurio)
# ==============================================================================
# OAuth2 Client Secret - Get from Keycloak: Clients → apicurio-registry → Credentials
OAUTH2_CLIENT_SECRET=your-apicurio-client-secret-here

# OAuth2 HMAC Secret - Generate with: openssl rand -base64 32
OAUTH2_HMAC_SECRET=your-generated-hmac-secret-here

# ==============================================================================
# REDIS CONFIGURATION
# ==============================================================================
# Redis is always deployed with the gateway for rate limiting
REDIS_PASSWORD=  # Leave empty for dev, set in production
REDIS_PORT=6379
